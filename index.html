
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta
            name="description"
            content="Documentation for the MicroPay Payment API"
        >
    <title>MicroPay Payment API</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-c9d8fa83.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-953e3353.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-b12a2749.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="index" data-languages="[&quot;json&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-4001f183.png" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="json">json</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#preparation-before-access" class="toc-h1 toc-link" data-title="Preparation before access">Preparation before access</a>
          </li>
          <li>
            <a href="#development-guidelines" class="toc-h1 toc-link" data-title="Development Guidelines">Development Guidelines</a>
          </li>
          <li>
            <a href="#api-list" class="toc-h1 toc-link" data-title="API List">API List</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#payment-by-user-code" class="toc-h2 toc-link" data-title="Payment by user code">Payment by user code</a>
                  </li>
                  <li>
                    <a href="#query-order" class="toc-h2 toc-link" data-title="Query Order">Query Order</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='#'>Sign Up for a Developer Key</a></li>
            <li><a href='https://github.com/slatedocs/slate'>Documentation Powered by Wavpay Systems Sdn. Bhd</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Function Description:</p>

<p>Welcome to the MicroPay Payment API! Payment code payment means that the user displays the &quot;payment code&quot; in WayPay to the merchant system to scan and complete the payment directly. It is suitable for face-to-face cashier scenarios in offline places, such as supermarkets, convenience stores, restaurants, and other physical places with clear business addresses. </p>
<h1 id='preparation-before-access'>Preparation before access</h1>
<p>Parameter application: </p>

<p>Merchants need to apply for a merchant ID (mchId) and a merchant key (apikey) on the platform to open the payment interface.
Merchant ID is the unique identifier of the merchant. This parameter is required for most of merchant settlement and record query.
Merchant secret key is mainly used for signature verification of data exchange information, which is the security guarantee for data access.</p>

<p>Obtain a certificate:</p>

<p>The platform has not yet used the certificate, and it may increase in the later period. Please pay attention to the notice of the platform.</p>
<h1 id='development-guidelines'>Development Guidelines</h1>
<p>Signature Generation:</p>

<p>Merchants can follow the steps below to generate a requested signature. The following process will take the java language as an example, please convert other languages by yourself
NOTE
Merchant need to have a merchant ID and a merchant key for signature generation.</p>
<div class="highlight"><pre class="highlight java tab-java"><code><span class="nc">Construct</span> <span class="n">the</span> <span class="nl">signature:</span>

<span class="mi">1</span><span class="o">)</span> <span class="nc">Obtain</span> <span class="n">the</span> <span class="n">required</span> <span class="n">parameter</span> <span class="n">values</span> <span class="n">according</span> <span class="n">to</span> <span class="n">the</span> <span class="n">introduction</span> <span class="n">of</span> <span class="n">the</span> <span class="n">request</span> <span class="n">api</span><span class="o">,</span> <span class="n">and</span> <span class="n">ensure</span> <span class="n">that</span> <span class="n">all</span> <span class="n">parameter</span> <span class="n">values</span> <span class="n">are</span> <span class="n">converted</span> <span class="n">to</span> <span class="n">string</span> <span class="n">types</span><span class="o">.</span>

<span class="mi">2</span><span class="o">)</span> <span class="nc">Get</span> <span class="n">the</span> <span class="n">current</span> <span class="n">timestamp</span> <span class="n">of</span> <span class="n">the</span> <span class="n">system</span> <span class="n">when</span> <span class="n">the</span> <span class="n">request</span> <span class="n">was</span> <span class="n">initiated</span><span class="o">,</span> <span class="n">that</span> <span class="n">is</span><span class="o">,</span> <span class="n">the</span> <span class="n">total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">milliseconds</span> <span class="n">from</span> <span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span> <span class="nc">On</span> <span class="nc">January</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1970</span> <span class="no">GMT</span> <span class="n">to</span> <span class="n">the</span> <span class="n">present</span><span class="o">,</span> <span class="n">as</span> <span class="n">the</span> <span class="n">request</span><span class="o">.</span> 

        <span class="mi">1</span><span class="o">.</span>  <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>

<span class="mi">3</span><span class="o">)</span> <span class="nc">Put</span> <span class="n">the</span> <span class="n">request</span> <span class="n">parameter</span> <span class="n">and</span> <span class="n">timestamp</span> <span class="n">into</span> <span class="n">the</span> <span class="n">map</span> <span class="n">in</span> <span class="n">turn</span> <span class="n">to</span> <span class="n">obtain</span> <span class="n">the</span> <span class="n">main</span> <span class="n">body</span> <span class="n">data</span> <span class="n">of</span> <span class="n">the</span> <span class="n">request</span> <span class="n">message</span> <span class="o">,</span> <span class="n">as</span> <span class="n">follows</span> <span class="o">:</span>
        <span class="mi">1</span><span class="o">.</span>    <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;();</span>
        <span class="mi">2</span><span class="o">.</span>    <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"mchId"</span><span class="o">,</span> <span class="s">"202006001"</span><span class="o">);</span>
        <span class="mi">3</span><span class="o">.</span>    <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"mchOrderId"</span><span class="o">,</span> <span class="s">"333333333333"</span><span class="o">);</span>
        <span class="mi">4</span><span class="o">.</span>    <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"timestamp"</span><span class="o">,</span> <span class="s">"1646733298647"</span><span class="o">);</span>

<span class="mi">4</span><span class="o">)</span> <span class="nc">Obtain</span> <span class="n">the</span> <span class="n">parameter</span> <span class="n">name</span> <span class="n">and</span> <span class="n">sort</span> <span class="n">the</span> <span class="n">string</span> <span class="n">according</span> <span class="n">to</span> <span class="n">the</span> <span class="no">ASCLL</span> <span class="n">code</span><span class="o">.</span> <span class="nc">After</span> <span class="n">completion</span><span class="o">,</span> <span class="n">connect</span> <span class="n">the</span> <span class="n">parameter</span> <span class="n">values</span> <span class="n">in</span> <span class="n">the</span> <span class="n">following</span> <span class="n">order</span><span class="o">,</span> <span class="n">filter</span> <span class="n">out</span> <span class="n">the</span> <span class="kc">null</span> <span class="n">values</span> <span class="n">when</span> <span class="n">connecting</span><span class="o">,</span> <span class="n">and</span> <span class="n">use</span> <span class="err">“</span><span class="no">I</span><span class="err">”</span> <span class="n">to</span> <span class="n">connect</span> <span class="n">two</span> <span class="n">adjacent</span> <span class="n">data</span><span class="o">.</span>

        <span class="mi">1</span><span class="o">.</span>  <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">keys</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">(</span><span class="n">params</span><span class="o">.</span><span class="na">keySet</span><span class="o">());</span>
        <span class="mi">2</span><span class="o">.</span>    <span class="nc">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">keys</span><span class="o">);</span>
        <span class="mi">3</span><span class="o">.</span>    <span class="nc">StringBuilder</span> <span class="n">content</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
        <span class="mi">4</span><span class="o">.</span>    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">keys</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
        <span class="mi">5</span><span class="o">.</span>     <span class="nc">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">keys</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="mi">6</span><span class="o">.</span>     <span class="nc">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
        <span class="mi">7</span><span class="o">.</span>     <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">keys</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
        <span class="mi">8</span><span class="o">.</span>      <span class="n">content</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
        <span class="mi">9</span><span class="o">.</span>     <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="mi">10</span><span class="o">.</span>     <span class="n">content</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">value</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="err">“</span><span class="o">|</span><span class="err">”</span><span class="o">);</span>
        <span class="mi">11</span><span class="o">.</span>    <span class="o">}</span>
        <span class="mi">12</span><span class="o">.</span>   <span class="o">}</span>

<span class="mi">5</span><span class="o">)</span> <span class="nc">After</span> <span class="n">the</span> <span class="n">data</span> <span class="n">connection</span> <span class="n">is</span> <span class="n">completed</span> <span class="o">,</span> <span class="n">add</span> <span class="n">the</span> <span class="n">merchant</span><span class="err">’</span><span class="n">s</span> <span class="n">secret</span> <span class="n">key</span> <span class="n">at</span> <span class="n">the</span> <span class="n">end</span><span class="o">,</span> <span class="n">encrypt</span> <span class="n">the</span> <span class="kd">final</span> <span class="n">result</span> <span class="n">with</span> <span class="no">SHA</span><span class="o">-</span><span class="mi">256</span> <span class="mi">16</span> <span class="n">digit</span> <span class="o">,</span><span class="n">convert</span> <span class="n">it</span> <span class="n">into</span> <span class="n">a</span> <span class="n">hexadecimal</span> <span class="n">string</span> <span class="o">,</span> <span class="n">and</span> <span class="n">convert</span> <span class="n">the</span> <span class="nc">English</span> <span class="n">to</span> <span class="n">capital</span><span class="o">.</span>

        <span class="mi">1</span><span class="o">.</span>  <span class="nc">MessageDigest</span> <span class="n">messageDigest</span><span class="o">;</span>
        <span class="mi">2</span><span class="o">.</span>    <span class="nc">String</span> <span class="n">encodeStr</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="mi">3</span><span class="o">.</span>    <span class="k">try</span> <span class="o">{</span>
        <span class="mi">4</span><span class="o">.</span>     <span class="n">messageDigest</span> <span class="o">=</span> <span class="nc">MessageDigest</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"SHA-256"</span><span class="o">);</span>
        <span class="mi">5</span><span class="o">.</span>     <span class="n">messageDigest</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="s">"UTF-8"</span><span class="o">));</span>
        <span class="mi">6</span><span class="o">.</span>     <span class="n">encodeStr</span> <span class="o">=</span> <span class="n">byte2Hex</span><span class="o">(</span><span class="n">messageDigest</span><span class="o">.</span><span class="na">digest</span><span class="o">());</span>
        <span class="mi">7</span><span class="o">.</span>    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="mi">8</span><span class="o">.</span>     <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="mi">9</span><span class="o">.</span>    <span class="o">}</span>
        <span class="mi">10</span><span class="o">.</span> <span class="n">encodeStr</span><span class="o">=</span> <span class="n">encodeStr</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">();</span>

<span class="nc">Signature</span> <span class="nl">Verification:</span>

<span class="nc">Signature</span> <span class="n">verification</span> <span class="n">is</span> <span class="n">to</span> <span class="n">perform</span> <span class="n">data</span> <span class="n">screening</span> <span class="n">on</span> <span class="n">the</span> <span class="n">acquired</span> <span class="n">information</span><span class="o">,</span> <span class="n">remove</span> <span class="n">the</span> <span class="n">signature</span> <span class="nf">field</span> <span class="o">(</span><span class="n">secureHash</span><span class="o">)</span> <span class="n">from</span> <span class="n">the</span> <span class="n">acquired</span> <span class="n">data</span><span class="o">,</span> <span class="n">generate</span> <span class="n">a</span> <span class="n">signature</span> <span class="k">for</span> <span class="n">the</span> <span class="n">remaining</span> <span class="n">data</span> <span class="n">according</span> <span class="n">to</span> <span class="n">the</span> <span class="n">signature</span> <span class="n">generation</span> <span class="n">process</span><span class="o">,</span> <span class="n">and</span> <span class="n">compare</span> <span class="n">the</span> <span class="n">result</span> <span class="n">with</span> <span class="n">the</span> <span class="n">acquired</span> <span class="n">signature</span> <span class="n">fail</span><span class="o">.</span>

<span class="nc">Signature</span> <span class="nl">example:</span>
        <span class="mi">1</span><span class="o">.</span>  <span class="n">parameter</span><span class="err">：</span>
        <span class="mi">2</span><span class="o">.</span>  <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"mchId"</span><span class="o">,</span> <span class="s">"202006001"</span><span class="o">);</span>
        <span class="mi">3</span><span class="o">.</span>    <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"mchOrderId"</span><span class="o">,</span> <span class="s">"333333333333"</span><span class="o">);</span>
        <span class="mi">4</span><span class="o">.</span>    <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"timestamp"</span><span class="o">,</span> <span class="s">"1646733298647"</span><span class="o">);</span>
        <span class="mi">5</span><span class="o">.</span>  
        <span class="mi">6</span><span class="o">.</span>  <span class="nc">Secret</span> <span class="n">key</span><span class="err">：</span>
        <span class="mi">7</span><span class="o">.</span>    <span class="nc">String</span> <span class="n">key</span> <span class="o">=</span> <span class="s">"P8yAFr213xcvb41xfgkjELoOhWl"</span><span class="o">;</span>
        <span class="mi">8</span><span class="o">.</span>  
        <span class="mi">9</span><span class="o">.</span>  <span class="nc">Sort</span> <span class="n">concatenated</span> <span class="n">strings</span><span class="err">：</span><span class="mi">202006001</span><span class="o">|</span><span class="mi">333333333333</span><span class="o">|</span><span class="mi">1646733298647</span><span class="o">|</span><span class="nc">P8yAFr213xcvb41xfgkjELoOhWl</span>
        <span class="mi">10</span><span class="o">.</span> <span class="n">sign</span><span class="err">：</span><span class="mi">70</span><span class="no">B6E3540261C9BBBF232C3604BDF4CD24ACB25EED5F4EB284CC68A359672782</span>


</code></pre></div>
<!-- # Authentication

> To authorize, use this code:

```ruby
require 'kittn'

api = Kittn::APIClient.authorize!('meowmeowmeow')
```

> Make sure to replace `meowmeowmeow` with your API key.

Kittn uses API keys to allow access to the API. You can register a new Kittn API key at our [developer portal](http://example.com/developers).

Kittn expects for the API key to be included in all API requests to the server in a header that looks like the following:

`Authorization: meowmeowmeow`

<aside class="notice">
You must replace <code>meowmeowmeow</code> with your personal API key.
</aside> -->
<h1 id='api-list'>API List</h1>
<p>The IPs and ports of the interface addresses in the list are only examples, and the specific access addresses will be notified separately.</p>
<h2 id='payment-by-user-code'>Payment by user code</h2>
<p>After the cashier uses the scanning device to read the payment code of the WayPay user, the QR code or barcode information will be transmitted to the merchant&#39;s cashier, and the merchant&#39;s cashier or the merchant&#39;s background will call this interface to initiate payment.
Note: After submitting the payment request, WayPay will return the payment result synchronously. When the returned result is &quot;system error&quot;, the merchant&#39;s system waits for 5 seconds and then calls the [Query Order API] to check the actual transaction result confirmation of payment;</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code>
<span class="s2">`POST http://example.com/api/micropay/micropay`</span>

</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"mchId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"202006001"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"mchOrderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"333333333333"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.00"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"goodsInfo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"discount"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nl">"point"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nl">"payCode"</span><span class="p">:</span><span class="s2">"395865319883277944"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1646733298647"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"secureHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2C7698D45C68C30B769AC5CA7F76A6EA2CB1768E2B2D1AF63E31E8BA8D2B528F"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>The example of return result:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"code"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"msg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"merchantOrderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"333333333333"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"wavpayOrderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4202203101714486756706"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"mchId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"202006001"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"merchantName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"LPR Parking System"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"tradeTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-03-10 17:14:49"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"payTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-03-10 17:56:23"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"paySence"</span><span class="p">:</span><span class="w"> </span><span class="s2">" MICROPAY"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"tradeStatus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PAID"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.00"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"goodsInfo"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1646985721445"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"secureHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"40B41942BC9708F89BB18D752AA9E6145A92ADC932853488BA8242DA69A9D52B"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint for payment by user code.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST http://example.com/api/micropay/micropay</code></p>
<h3 id='query-parameters'>Query Parameters</h3>
<table><thead>
<tr>
<th>Name</th>
<th>YES/NO</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>mchId</td>
<td>YES</td>
<td>Merchant id</td>
</tr>
<tr>
<td>mchOrderId</td>
<td>YES</td>
<td>Merchant order id</td>
</tr>
<tr>
<td>amount</td>
<td>YES</td>
<td>amount</td>
</tr>
<tr>
<td>goodsInfo</td>
<td>YES</td>
<td>Product info no empty string is passed</td>
</tr>
<tr>
<td>discount</td>
<td>YES</td>
<td>Discount ,no empty string</td>
</tr>
<tr>
<td>point</td>
<td>YES</td>
<td>Point ,no empty string passed</td>
</tr>
<tr>
<td>payCode</td>
<td>YES</td>
<td>Payment code</td>
</tr>
<tr>
<td>timestamp</td>
<td>YES</td>
<td>Request timestamp</td>
</tr>
<tr>
<td>secureHash</td>
<td>YES</td>
<td>sign</td>
</tr>
</tbody></table>
<h3 id='return-result-description'>Return result description</h3>
<table><thead>
<tr>
<th>Name</th>
<th>YES/NO</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>code</td>
<td>YES</td>
<td>Result code, 0 : success</td>
</tr>
<tr>
<td>msg</td>
<td>YES</td>
<td>Result message</td>
</tr>
<tr>
<td>data</td>
<td>YES</td>
<td>Result data</td>
</tr>
</tbody></table>
<h3 id='data-result-set-description'>Data result set description</h3>
<table><thead>
<tr>
<th>Name</th>
<th>YES/NO</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>merchantOrderId</td>
<td>YES</td>
<td>Merchant Order ID</td>
</tr>
<tr>
<td>wavpayOrderId</td>
<td>YES</td>
<td>Wavpay Order ID</td>
</tr>
<tr>
<td>mchId</td>
<td>YES</td>
<td>Merchant ID</td>
</tr>
<tr>
<td>merchantName</td>
<td>YES</td>
<td>Merchant name</td>
</tr>
<tr>
<td>tradeTime</td>
<td>YES</td>
<td>Trade time</td>
</tr>
<tr>
<td>payTime</td>
<td>YES</td>
<td>Payment time</td>
</tr>
<tr>
<td>paySence</td>
<td>YES</td>
<td>Type of Pay：MICROPAY</td>
</tr>
<tr>
<td>tradeStatus</td>
<td>YES</td>
<td>Order Status：NEW, PAID, PENDING, FAILED, REFUND_IN_PROCESS, REFUNDED, REFUND_FAILED</td>
</tr>
<tr>
<td>amount</td>
<td>YES</td>
<td>amount</td>
</tr>
<tr>
<td>goodsInfo</td>
<td>YES</td>
<td>Product info no empty string is passed</td>
</tr>
<tr>
<td>timestamp</td>
<td>YES</td>
<td>Request timestamp</td>
</tr>
<tr>
<td>secureHash</td>
<td>YES</td>
<td>Sign</td>
</tr>
</tbody></table>
<h2 id='query-order'>Query Order</h2>
<p>Merchants can actively query the order status through the query order interface to complete the next business logic. The order status can be inquired through the merchant&#39;s order number.
Need to call the query interface：</p>

<p>• When there is an abnormality in the merchant&#39;s background, network, server, etc., the merchant&#39;s system does not receive the payment notification in the end.</p>

<p>• After calling the payment interface, it returns a system error or unknown transaction status.</p>

<p>• Before calling the order closing API, you need to confirm the payment status.</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code>

<span class="s2">`POST http://example.com/api/micropay/queryBill`</span>

</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"mchId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"202006001"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"mchOrderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"333333333333"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1646733298647"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"secureHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"40B41942BC9708F89BB18D752AA9E6145A92ADC932853488BA8242DA69A9D52B"</span><span class="w">
</span><span class="p">}</span><span class="w">


</span></code></pre></div>
<blockquote>
<p>The example of return result:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"code"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"msg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"merchantOrderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"333333333333"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"wavpayOrderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4202203101714486756706"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"mchId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"202006001"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"merchantName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"LPR Parking System"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"tradeTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-03-10 17:14:49"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"payTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-03-10 17:56:23"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"paySence"</span><span class="p">:</span><span class="w"> </span><span class="s2">" MICROPAY"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"tradeStatus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PAID"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.00"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"goodsInfo"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1646985721445"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"secureHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"40B41942BC9708F89BB18D752AA9E6145A92ADC932853488BA8242DA69A9D52B"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div><h3 id='http-request-2'>HTTP Request</h3>
<p><code>POST http://example.com/api/micropay/queryBill</code></p>
<h3 id='request-description'>Request Description</h3>
<table><thead>
<tr>
<th>Name</th>
<th>YES/NO</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>mchId</td>
<td>YES</td>
<td>Merchant id</td>
</tr>
<tr>
<td>mchOrderId</td>
<td>YES</td>
<td>Merchant order id</td>
</tr>
<tr>
<td>timestamp</td>
<td>YES</td>
<td>Request timestamp</td>
</tr>
<tr>
<td>secureHash</td>
<td>YES</td>
<td>sign</td>
</tr>
</tbody></table>
<h3 id='return-result-description-2'>Return result description</h3>
<table><thead>
<tr>
<th>Name</th>
<th>YES/NO</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>code</td>
<td>YES</td>
<td>Result code, 0 : success</td>
</tr>
<tr>
<td>msg</td>
<td>YES</td>
<td>Result message</td>
</tr>
<tr>
<td>data</td>
<td>YES</td>
<td>Result data</td>
</tr>
</tbody></table>
<h3 id='data-result-set-description-2'>Data result set description</h3>
<table><thead>
<tr>
<th>Name</th>
<th>YES/NO</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>merchantOrderId</td>
<td>YES</td>
<td>Merchant Order ID</td>
</tr>
<tr>
<td>wavpayOrderId</td>
<td>YES</td>
<td>Wavpay Order ID</td>
</tr>
<tr>
<td>mchId</td>
<td>YES</td>
<td>Merchant ID</td>
</tr>
<tr>
<td>merchantName</td>
<td>YES</td>
<td>Merchant name</td>
</tr>
<tr>
<td>tradeTime</td>
<td>YES</td>
<td>Trade time</td>
</tr>
<tr>
<td>payTime</td>
<td>YES</td>
<td>Payment time</td>
</tr>
<tr>
<td>paySence</td>
<td>YES</td>
<td>Type of Pay：MICROPAY</td>
</tr>
<tr>
<td>tradeStatus</td>
<td>YES</td>
<td>Order Status：NEW, PAID, PENDING, FAILED, REFUND_IN_PROCESS, REFUNDED, REFUND_FAILED</td>
</tr>
<tr>
<td>amount</td>
<td>YES</td>
<td>amount</td>
</tr>
<tr>
<td>goodsInfo</td>
<td>YES</td>
<td>Product info no empty string is passed</td>
</tr>
<tr>
<td>timestamp</td>
<td>YES</td>
<td>Request timestamp</td>
</tr>
<tr>
<td>secureHash</td>
<td>YES</td>
<td>Sign</td>
</tr>
</tbody></table>
<h1 id='errors'>Errors</h1>
<p>The MicroPay Payment API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>500</td>
<td>Internel server error</td>
</tr>
<tr>
<td>1021</td>
<td>Param error</td>
</tr>
<tr>
<td>1022</td>
<td>Merchant locked</td>
</tr>
<tr>
<td>1023</td>
<td>Merchant order paid</td>
</tr>
<tr>
<td>1024</td>
<td>merchant order paying</td>
</tr>
<tr>
<td>1025</td>
<td>Order closed</td>
</tr>
<tr>
<td>1028</td>
<td>Insufficient balance</td>
</tr>
<tr>
<td>1031</td>
<td>No merchant related records</td>
</tr>
<tr>
<td>1032</td>
<td>Duplicate merchant order number</td>
</tr>
<tr>
<td>1033</td>
<td>Merchant order number error</td>
</tr>
<tr>
<td>1035</td>
<td>Signature error</td>
</tr>
<tr>
<td>1036</td>
<td>QR code expired</td>
</tr>
<tr>
<td>1040</td>
<td>App user does not exist</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="json">json</a>
          </div>
      </div>
    </div>
  </body>
</html>
